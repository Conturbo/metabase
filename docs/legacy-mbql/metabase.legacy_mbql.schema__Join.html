<html><head></head><body style="margin: 0;"><h1><pre>Join</pre></h1><div><div><p>Perform the equivalent of a SQL <code>JOIN</code> with another Table or nested <code>:source-query</code>. JOINs are either explicitly
specified in the incoming query, or implicitly generated when one uses a <code>:field</code> clause with <code>:source-field</code>.</p>
<p>In the top-level query, you can reference Fields from the joined table or nested query by including <code>:source-field</code>
in the <code>:field</code> options (known as implicit joins); for explicit joins, you <em>must</em> specify <code>:join-alias</code> yourself; in
the <code>:field</code> options, e.g.</p>
<pre><code>;; for joins against other Tables/MBQL source queries
[:field 1 {:join-alias &quot;my_join_alias&quot;}]

;; for joins against native queries
[:field &quot;my_field&quot; {:base-type :field/Integer, :join-alias &quot;my_join_alias&quot;}]
</code></pre>
</div><div><div>Must satisfy all of these:<ul><li><div>A map with the following keys:<table><thead><tr><th>Key</th><th>Schema</th></tr></thead><tbody><tr style="border: 1px solid black;"><td style="border: 1px solid black; background: #cccccc;"><pre>source-table</pre><i>Optional.</i></td><td style="border: 1px solid black;"><div><p><em>What</em> to JOIN. Self-joins can be done by using the same <code>:source-table</code> as in the query where
this is specified. YOU MUST SUPPLY EITHER <code>:source-table</code> OR <code>:source-query</code>, BUT NOT BOTH!</p>
</div><div><div>Must be one of these:<ul><li><a href="metabase.lib.schema.id__table.html"><p>Valid Table ID</p>
</a></li><li><div><div><p><code>card__&lt;id&gt;</code> string Table ID</p>
</div><div><div></div></div></div></li></ul></div></div></td></tr><tr style="border: 1px solid black;"><td style="border: 1px solid black; background: #cccccc;"><pre>source-query</pre><i>Optional.</i></td><td style="border: 1px solid black;"><div></div><div><div>One of the following types of expressions:<table><thead><tr><th>Type</th><th>Schema</th></tr></thead><tbody><tr style="border: 1px solid black;"><td style="border: 1px solid black; background: #cccccc;"><pre>native</pre></td><td style="border: 1px solid black;"><div></div><div><a href="metabase.legacy_mbql.schema__NativeSourceQuery.html"><pre>NativeSourceQuery</pre></a></div></td></tr><tr style="border: 1px solid black;"><td style="border: 1px solid black; background: #cccccc;"><pre>mbql</pre></td><td style="border: 1px solid black;"><div></div><div><a href="metabase.legacy_mbql.schema__MBQLQuery.html"><pre>MBQLQuery</pre></a></div></td></tr></tbody></table></div></div></td></tr><tr style="border: 1px solid black;"><td style="border: 1px solid black; background: #cccccc;"><pre>condition</pre></td><td style="border: 1px solid black;"><div><p>The condition on which to JOIN. Can be anything that is a valid <code>:filter</code> clause. For automatically-generated
JOINs this is always</p>
<pre><code>[:= &lt;source-table-fk-field&gt; [:field &lt;dest-table-pk-field&gt; {:join-alias &lt;join-table-alias&gt;}]]
</code></pre>
</div><div><a href="metabase.legacy_mbql.schema__Filter.html"><pre>Filter</pre></a></div></td></tr><tr style="border: 1px solid black;"><td style="border: 1px solid black; background: #cccccc;"><pre>strategy</pre><i>Optional.</i></td><td style="border: 1px solid black;"><div><p>Defaults to <code>:left-join</code>; used for all automatically-generated JOINs</p>
<p>Driver implementations: this is guaranteed to be present after pre-processing.</p>
</div><div><div>Must be equal to one of these:<ul><li><pre>:full-join</pre></li><li><pre>:right-join</pre></li><li><pre>:left-join</pre></li><li><pre>:inner-join</pre></li></ul></div></div></td></tr><tr style="border: 1px solid black;"><td style="border: 1px solid black; background: #cccccc;"><pre>fields</pre><i>Optional.</i></td><td style="border: 1px solid black;"><div><p>The Field to include in the results <em>if</em> a top-level <code>:fields</code> clause <em>is not</em> specified. This can be either
<code>:none</code>, <code>:all</code>, or a sequence of Field clauses.</p>
<ul>
<li>
<p><code>:none</code>: no Fields from the joined table or nested query are included (unless indirectly included by breakouts or
other clauses). This is the default, and what is used for automatically-generated joins.</p>
</li>
<li>
<p><code>:all</code>: will include all of the Field from the joined table or query</p>
</li>
<li>
<p>a sequence of Field clauses: include only the Fields specified. Valid clauses are the same as the top-level
<code>:fields</code> clause. This should be non-empty and all elements should be distinct. The normalizer will automatically
remove duplicate fields for you, and replace empty clauses with <code>:none</code>.</p>
</li>
</ul>
<p>Driver implementations: you can ignore this clause. Relevant fields will be added to top-level <code>:fields</code> clause with
appropriate aliases.</p>
</div><div><div><div><p>Valid join <code>:fields</code>: <code>:all</code>, <code>:none</code>, or a sequence of <code>:field</code> clauses that have <code>:join-alias</code>.</p>
</div><div><div>Must be one of these:<ul><li><div>Must be equal to one of these:<ul><li><pre>:all</pre></li><li><pre>:none</pre></li></ul></div></li><li><a href="metabase.legacy_mbql.schema__Fields.html"><pre>Fields</pre></a></li></ul></div></div></div></div></td></tr><tr style="border: 1px solid black;"><td style="border: 1px solid black; background: #cccccc;"><pre>alias</pre><i>Optional.</i></td><td style="border: 1px solid black;"><div><p>The name used to alias the joined table or query. This is usually generated automatically and generally looks
like <code>table__via__field</code>. You can specify this yourself if you need to reference a joined field with a <code>:join-alias</code>
in the options.</p>
<p>Driver implementations: This is guaranteed to be present after pre-processing.</p>
</div><div><a href="metabase.lib.schema.common__non_blank_string.html"><pre>non-blank-string</pre></a></div></td></tr><tr style="border: 1px solid black;"><td style="border: 1px solid black; background: #cccccc;"><pre>fk-field-id</pre><i>Optional.</i></td><td style="border: 1px solid black;"><div><p>Used internally, only for annotation purposes in post-processing. When a join is implicitly
generated via a <code>:field</code> clause with <code>:source-field</code>, the ID of the foreign key field in the source Table will be
recorded here. This information is used to add <code>fk_field_id</code> information to the <code>:cols</code> in the query results; I
believe this is used to facilitate drill-thru? :shrug:</p>
<p>Don't set this information yourself. It will have no effect.</p>
</div><div><div>Either <code>nil</code>, or <div><a href="metabase.lib.schema.id__field.html"><p>Valid Field ID</p>
</a></div></div></div></td></tr><tr style="border: 1px solid black;"><td style="border: 1px solid black; background: #cccccc;"><pre>source-metadata</pre><i>Optional.</i></td><td style="border: 1px solid black;"><div><p>Metadata about the source query being used, if pulled in from a Card via the
<code>:source-table &quot;card__id&quot;</code> syntax. added automatically by the <code>resolve-card-id-source-tables</code> middleware.</p>
</div><div><div>Either <code>nil</code>, or <div><div><div>A sequence of:</div><div><a href="metabase.legacy_mbql.schema__SourceQueryMetadata.html"><pre>SourceQueryMetadata</pre></a></div></div></div></div></div></td></tr></tbody></table></div></li><li><div><div><p>Joins must have either a <code>source-table</code> or <code>source-query</code>, but not both.</p>
</div><div><div></div></div></div></li></ul></div></div></div></body></html>